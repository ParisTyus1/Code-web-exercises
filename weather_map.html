<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dark SKy Call</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <style>
        .weather-cards{
            width: 70em;

        }
        #Today-weather{
            border: 3px solid black;
            border-radius: inherit;

        }
        #Tomorrow-weather{
            border: 3px solid black;
            border-radius: inherit;
        }
        #Next-weather{
            border: 3px solid black;
            border-radius: inherit;
        }
        .jumbotron{
            background-image: url("img/San-Antonio.gif");
            height: 50vh;
            width: 100%;
            background-repeat: no-repeat;
            background-size: cover;
        }

        body{
            background-color: lightblue;
        }

        #title1{
            font-size: 5em;
        }
        #title2{
            font-size: 3em;
        }



        #map{
            display: flex;
            justify-content: center;
            height: 600px;
            width: 1000px;
            border-color: black;

        }

    </style>
</head>
<body>

<div class="img-fluid jumbotron jumbotron-fluid">
    <div class="container">
        <h1 class=" display-4 text-white" id="title1">Weather</h1>
        <h3 class="text-white" id="title2">San Antonio</h3>
    </div>
</div>





 <div class="row justify-content-center">
    <div class="weather-cards d-flex justify-content-around">
        <div class="card col-3 text-white bg-info" style="">
            <div class="Today-weather weatherCards" id="Today-weather"></div>
        </div>

        <div class="card col-3 text-white bg-info" style="max-width: 18rem">
            <div class="Tomorrow-weather weatherCards" id="Tomorrow-weather"></div>
        </div>

        <div class="card col-3 text-white bg-info" style="max-width: 18rem">
            <div class="Next-weather weatherCards" id="Next-weather"></div>
        </div>
    </div>
</div>

<div class="row d-flex justify-content-center">
    <form>
        Latitude:<br>

        <input type="text" name="latitude" placeholder="Enter Latitude Here" id="lat">
        <br>
        Longitude:<br>

        <input type="text" name="longitude" placeholder="Enter Longitude Here" id="long">
        <br>

        <input type="submit" value="Submit" id="go-getter">
    </form>
</div>







<div id ='map'>

</div>

<!--    <div id="stuff"></div>-->


<!--<span class="header-right__weather-icon"></span>-->
<!--<span class="header-right__weather-sit"></span>-->
<!--<span class="header-right__weather-temp"></span>-->


<!--<script src="https://code.jquery.com/jquery-2.2.4.min.js"-->
<!--        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>-->

<script src="js/keys.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<!--<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>-->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script src="js/keys.js"></script>


<script>
    (function () {
    var weatherType = {
        "clear-day":"img/climacons-master/SVG/Cloud-Drizzle-Sun-Alt.svg",
        "clear-night":"img/climacons-master/SVG/Cloud-Fog.svg",
        "rain":"img/climacons-master/SVG/Sun.svg",
        "snow":"img/climacons-master/SVG/Cloud-Sun.svg",
        "sleet":"img/climacons-master/SVG/Cloud-Fog.svg",
        "wind":"img/climacons-master/SVG/Cloud-Rain-Alt.svg",
        "fog":"img/climacons-master/SVG/Cloud-Refresh.svg",
        "cloudy":"img/climacons-master/SVG/Cloud-Snow-Sun.svg",
        "partly-cloudy-day":"img/climacons-master/SVG/Sun.svg",
        "partly-cloudy-night":"img/climacons-master/SVG/Moon.svg"};












    "use strict";
    $(document).ready(function () {
        getWeather(29.4241, -98.4936);
        function getWeather(latitude, longitude) {
            var weather = $.ajax("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkskyToken + "/" + latitude + ',' + longitude);
            weather.done(function (weather) {
                // console.log(weather);
                for (var i = 0; i <= 2; i++) {

                }
                $('#Today-weather').empty().append(
                    '<div class="d-flex-col justify-content-center">' +
                    '<h5 class="d-flex justify-content-center">' + "Current Weather " + '</h5>' +
                    '<img src="' + weatherType[weather.daily.data[0].icon] + '" class="mt-2" style="width: 30%">' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.currently.temperature + '° F' + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.currently.summary + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.currently.humidity + "%" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.currently.windSpeed + " MPH" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.currently.pressure + '</p>' +
                    '</div>');

                $('#Tomorrow-weather').empty().append(
                    '<div class="d-flex-col justify-content-center">' +
                    '<h5 class="d-flex justify-content-center">' + "Current Weather " + '</h5>' +
                    '<img src="' + weatherType[weather.daily.data[1].icon] + '" class="mt-2" style="width: 30%">' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[1].temperatureHigh + '° F' + ' / ' + weather.daily.data[1].temperatureLow + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[1].summary + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[1].humidity + "%" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[1].windSpeed + " MPH" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[1].pressure + '</p>' +
                    '</div>');

                $('#Next-weather').empty().append(
                    '<div class="d-flex-col justify-content-center">' +
                    '<h5 class="d-flex justify-content-center">' + "Current Weather " + '</h5>' +
                    '<img src="' + weatherType[weather.daily.data[2].icon] + '" class="mt-2" style="width: 30%">' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[2].temperatureHigh + '° F' + ' / ' + weather.daily.data[2].temperatureLow + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[2].summary + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[2].humidity + "%" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[2].windSpeed + " MPH" + '</p>' +
                    '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[2].pressure + '</p>' +
                    '</div>');
            })
        }
        mapboxgl.accessToken = mapboxToken;

        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            zoom: 10,
            center: [-98.4916, 29.4252]
        });

        var markerOptions = {
            color: "#ff0000",
            draggable: true

        };
        //***********MArker Drag****************//
        var marker = new mapboxgl.Marker(markerOptions)//have to pass in marker options//
            .setLngLat([-98.4916, 29.4252])
            .addTo(map);

            marker.on('dragend',function () {
            var LngLat = marker.getLngLat();
            getWeather(LngLat.lat,LngLat.lng)
        });

        // var Popup = new mapboxgl.Popup()
        //     .setHTML("<p>54th St. Grille</p>")
        //     .addTo(marker);

        // marker.setPopup(grillePopup)//binding popup and marker//

        // var marker = new mapboxgl.Marker(markerOptions)//have to pass in marker options//
        //     .setLngLat(results)
        //     .addTo(map);

        $('#go-getter').click(function(e) {
            e.preventDefault();
            var longitude = long.value;
            var latitude = lat.value;

            reverseGeocode({lng: longitude, lat: latitude}, mapboxToken).then(function (result) {
                geocode(result, mapboxToken).then(function (result2) {
                    map.setCenter(result2);
                    map.setZoom(15);
                    var marker = new mapboxgl.Marker()
                        .setLngLat(result2)
                        .addTo(map);

                });

                // map.setCenter(result);
                // map.setZoom(11);




            });
            getWeather(lat.value, long.value);
        });






        // var weatherType = ["clear-day", "clear-night", "rain", "snow", "sleet", "wind", "fog", "cloudy", "partly-cloudy-day", "partly-cloudy-night"]
    });
    })();
    //2955742
    //-98.5349
</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


</body>
</html>